---
import '../styles/global.css'
import { Image } from 'astro:assets';
import Layout from '../layouts/Layout.astro';

import AppHeader from './Header.astro';
import AppFooter from './Footer.astro';
import CallToAction from './CallToAction.astro';

const { frontmatter } = Astro.props;

// Calculate reading time based on content length
const readingTime = frontmatter.readingTime || Math.ceil(frontmatter.content?.split(' ').length / 200) || 5;
const publishedDate = new Date(frontmatter.date).toLocaleDateString('en-US', {
  year: 'numeric',
  month: 'long',
  day: 'numeric'
});
---

<Layout title={frontmatter.title}>

<AppHeader />

<article class="min-h-screen">
  <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-16">
    <!-- Back navigation -->
    <nav class="mb-8 sm:mb-12">
      <a href="/blog/" class="inline-flex items-center gap-2 text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200">
        <i class="ri-arrow-left-line"></i>
        <span>Back to Case Studies</span>
      </a>
    </nav>

    <!-- Hero section -->
    <header class="mb-8 sm:mb-12 lg:mb-16">
      <div class="mb-6 sm:mb-8">
        <Image
          src={frontmatter.image.url}
          alt={frontmatter.image.alt || frontmatter.title}
          width={800}
          height={450}
          class="w-full h-auto max-h-[45vh] sm:max-h-[50vh] object-cover rounded-lg shadow-md"
          loading="eager"
        />
      </div>

      <h1 class="text-3xl sm:text-4xl lg:text-5xl font-bold text-gray-900 mb-4 sm:mb-6 leading-tight">
        {frontmatter.title}
      </h1>

      <div class="flex flex-wrap items-center gap-4 sm:gap-6 text-gray-600">
        <time datetime={frontmatter.date}>{publishedDate}</time>
        <span class="hidden sm:inline">â€¢</span>
        <span>{readingTime} min read</span>
        {frontmatter.tags && (
          <div class="flex flex-wrap gap-2">
            {frontmatter.tags.map((tag: string) => (
              <span class="px-3 py-1 bg-gray-100 text-gray-700 rounded-full text-sm">
                {tag}
              </span>
            ))}
          </div>
        )}
      </div>
    </header>

    <!-- Main content -->
    <div class="prose prose-lg prose-gray max-w-none">
      <div class="text-lg leading-relaxed space-y-6">
        {frontmatter.excerpt && (
          <p class="text-xl text-gray-600 italic mb-8 leading-relaxed">
            {frontmatter.excerpt}
          </p>
        )}
        <slot />
      </div>
    </div>

    <!-- Case study metadata if available -->
    {frontmatter.client || frontmatter.role || frontmatter.duration ? (
      <aside class="mt-12 sm:mt-16 p-6 sm:p-8 bg-gray-50 rounded-lg">
        <h2 class="text-xl sm:text-2xl font-semibold mb-4 sm:mb-6">Project Details</h2>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6">
          {frontmatter.client && (
            <div>
              <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide mb-2">Client</h3>
              <p class="text-gray-900">{frontmatter.client}</p>
            </div>
          )}
          {frontmatter.role && (
            <div>
              <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide mb-2">My Role</h3>
              <p class="text-gray-900">{frontmatter.role}</p>
            </div>
          )}
          {frontmatter.duration && (
            <div>
              <h3 class="text-sm font-medium text-gray-500 uppercase tracking-wide mb-2">Duration</h3>
              <p class="text-gray-900">{frontmatter.duration}</p>
            </div>
          )}
        </div>
      </aside>
    ) : null}
  </div>
</article>

<CallToAction />
<AppFooter />

</Layout>

